mappings:
- match: "*.db.tables.*.queries.*.duration"
  name: "mastodon_db_queries_duration"
  labels:
    namespace: "$1"
    table: "$2"
    action: "$3"
- match: "*.cache.*.duration"
  name: "mastodon_cache_duration"
  labels:
    namespace: "$1"
    action: "$2"
- match: "*.sidekiq.*"
  name: "mastodon_sidekiq_${2}"
  labels:
    namespace: "$1"
- match: "*.sidekiq.*.*"
  name: "mastodon_sidekiq_${3}"
  labels:
    namespace: "$1"
    worker: "$2"
- match: "(.*)\\.sidekiq\\.queues\\.(.*)\\.(.*)"
  match_type: "regex"
  name: "mastodon_sidekiq_queues_${3}"
  labels:
    namespace: "$1"
    queue: "$2"
- match: "*.sidekiq.*.*.*.*"
  name: "mastodon_sidekiq_${5}"
  labels:
    namespace: "$1"
    worker: "${2}_${4}"
- match: "*.sidekiq.*.*.*.*.*.*"
  name: "mastodon_sidekiq_${7}"
  labels:
    namespace: "$1"
    worker: "${2}_${4}_${6}"
- match: "*.sidekiq.*.*.*.*.*.*.*.*"
  name: "mastodon_sidekiq_${9}"
  labels:
    namespace: "$1"
    worker: "${2}_${4}_${6}_${8}"
- match: "*.web.*.*.*.*"
  name: "mastodon_web_${5}"
  labels:
    namespace: "$1"
    controller: "$2"
    endpoint: "$3"
    type: "$4"
- match: "*.web.*.*.*.status.*"
  name: "mastodon_web_status"
  labels:
    namespace: "$1"
    controller: "$2"
    endpoint: "$3"
    type: "$4"
    code: "$5"
- match: "*.web.*.*.*.*.*"
  name: "mastodon_web_${6}"
  labels:
    namespace: "$1"
    controller: "${2}_${3}"
    endpoint: "$4"
    type: "$5"
- match: "*.web.*.*.*.*.status.*"
  name: "mastodon_web_status"
  labels:
    namespace: "$1"
    controller: "${2}_${3}"
    endpoint: "$4"
    type: "$5"
    code: "$6"
- match: "*.web.*.*.*.*.*.*"
  name: "mastodon_web_${7}"
  labels:
    namespace: "$1"
    controller: "${2}_${3}_${4}"
    endpoint: "$5"
    type: "$6"
- match: "*.web.*.*.*.*.*.status.*"
  name: "mastodon_web_status"
  labels:
    namespace: "$1"
    controller: "${2}_${3}_${4}"
    endpoint: "$5"
    type: "$6"
    code: "$7"
- match: "*.web.*.*.*.*.*.*.*"
  name: "mastodon_web_${8}"
  labels:
    namespace: "$1"
    controller: "${2}_${3}_${4}_${5}"
    endpoint: "$6"
    type: "$7"
- match: "*.web.*.*.*.*.*.*.status.*"
  name: "mastodon_web_status"
  labels:
    namespace: "$1"
    controller: "${2}_${3}_${4}_${5}"
    endpoint: "$6"
    type: "$7"
    code: "$8"
